import{F as G,P as $,G as Z,H as p,R as X,I as O,J as x,V as Y,K as tt}from"./index-Cjo7FgaV.js";const at={ton:["ton_sendMessage","ton_signData"],solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},j={mainnet:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedMainnet:"4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ",devnet:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedDevnet:"8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"};function nt(i){return at[i]||[]}function et(i){return{methods:nt(i),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}}function st(i){return i.reduce((e,t)=>{const{id:a,chainNamespace:s,rpcUrls:r}=t,M=r.default.http[0];e[s]||(e[s]=et(s));const d=`${s}:${a}`,o=e[s];switch(o?.chains.push(d),d){case j.mainnet:o.chains.push(j.deprecatedMainnet);break;case j.devnet:o.chains.push(j.deprecatedDevnet);break}return o?.rpcMap&&M&&(o.rpcMap[a]=M),e},{})}const R=["solana:mainnet","solana:devnet","solana:testnet","solana:localnet"];var D=function(i,e,t,a){if(t==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?i!==e||!a:!e.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?a:t==="a"?a.call(i):a?a.value:e.get(i)},T=function(i,e,t,a,s){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?i!==e||!s:!e.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?s.call(i,t):s?s.value=t:e.set(i,t),t},_,S,z,E,m,W;class it{get address(){return D(this,_,"f")}get publicKey(){return D(this,S,"f").slice()}get chains(){return D(this,z,"f").slice()}get features(){return D(this,E,"f").slice()}get label(){return D(this,m,"f")}get icon(){return D(this,W,"f")}constructor({address:e,publicKey:t,label:a,icon:s}){_.set(this,void 0),S.set(this,void 0),z.set(this,void 0),E.set(this,void 0),m.set(this,void 0),W.set(this,void 0),T(this,_,e,"f"),T(this,S,t,"f"),T(this,z,R,"f"),T(this,E,["solana:signAndSendTransaction","solana:signTransaction","solana:signMessage"],"f"),T(this,m,a,"f"),T(this,W,s,"f")}}_=new WeakMap,S=new WeakMap,z=new WeakMap,E=new WeakMap,m=new WeakMap,W=new WeakMap;function Q(i){return R.includes(i)}function y(i){return"version"in i}var n=function(i,e,t,a){if(t==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?i!==e||!a:!e.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?a:t==="a"?a.call(i):a?a.value:e.get(i)},N=function(i,e,t,a,s){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?i!==e||!s:!e.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?s.call(i,t):s?s.value=t:e.set(i,t),t},A,w,k,l,C,b,c,P,K,B,g,L,I,q,F,v,H,U;function ot(i){return{"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"solana:mainnet","solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ":"solana:mainnet","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"solana:testnet","solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K":"solana:devnet","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1":"solana:devnet"}[i]}class V{static register(e){const t=new V(e);G(t)}get version(){return n(this,k,"f")}get name(){return n(this,C,"f")}get icon(){return n(this,b,"f")}get chains(){return R.slice()}get features(){return{"standard:connect":{version:"1.0.0",connect:n(this,q,"f")},"standard:disconnect":{version:"1.0.0",disconnect:n(this,F,"f")},"standard:events":{version:"1.0.0",on:n(this,P,"f")},"solana:signAndSendTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signAndSendTransaction:n(this,v,"f")},"solana:signTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signTransaction:n(this,H,"f")},"solana:signMessage":{version:"1.0.0",signMessage:n(this,U,"f")}}}get accounts(){const e=n(this,l,"f").session?.namespaces?.solana,t=e?.chains?.map(a=>ot(a));return e?.accounts.map(a=>{const{address:s}=$.parseCaipAddress(a),r=new Z(p.decode(s));return{address:s,publicKey:r.toBytes(),chains:t,features:["solana:signAndSendTransaction","solana:signTransaction","solana:signMessage"]}})||[]}constructor(e){A.add(this),w.set(this,{}),k.set(this,"1.0.0"),l.set(this,void 0),C.set(this,"WalletConnect"),b.set(this,"data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjE4NSIgdmlld0JveD0iMCAwIDMwMCAxODUiIHdpZHRoPSIzMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTYxLjQzODU0MjkgMzYuMjU2MjYxMmM0OC45MTEyMjQxLTQ3Ljg4ODE2NjMgMTI4LjIxMTk4NzEtNDcuODg4MTY2MyAxNzcuMTIzMjA5MSAwbDUuODg2NTQ1IDUuNzYzNDE3NGMyLjQ0NTU2MSAyLjM5NDQwODEgMi40NDU1NjEgNi4yNzY1MTEyIDAgOC42NzA5MjA0bC0yMC4xMzY2OTUgMTkuNzE1NTAzYy0xLjIyMjc4MSAxLjE5NzIwNTEtMy4yMDUzIDEuMTk3MjA1MS00LjQyODA4MSAwbC04LjEwMDU4NC03LjkzMTE0NzljLTM0LjEyMTY5Mi0zMy40MDc5ODE3LTg5LjQ0Mzg4Ni0zMy40MDc5ODE3LTEyMy41NjU1Nzg4IDBsLTguNjc1MDU2MiA4LjQ5MzYwNTFjLTEuMjIyNzgxNiAxLjE5NzIwNDEtMy4yMDUzMDEgMS4xOTcyMDQxLTQuNDI4MDgwNiAwbC0yMC4xMzY2OTQ5LTE5LjcxNTUwMzFjLTIuNDQ1NTYxMi0yLjM5NDQwOTItMi40NDU1NjEyLTYuMjc2NTEyMiAwLTguNjcwOTIwNHptMjE4Ljc2Nzc5NjEgNDAuNzczNzQ0OSAxNy45MjE2OTcgMTcuNTQ2ODk3YzIuNDQ1NTQ5IDIuMzk0Mzk2OSAyLjQ0NTU2MyA2LjI3NjQ3NjkuMDAwMDMxIDguNjcwODg5OWwtODAuODEwMTcxIDc5LjEyMTEzNGMtMi40NDU1NDQgMi4zOTQ0MjYtNi40MTA1ODIgMi4zOTQ0NTMtOC44NTYxNi4wMDAwNjItLjAwMDAxLS4wMDAwMS0uMDAwMDIyLS4wMDAwMjItLjAwMDAzMi0uMDAwMDMybC01Ny4zNTQxNDMtNTYuMTU0NTcyYy0uNjExMzktLjU5ODYwMi0xLjYwMjY1LS41OTg2MDItMi4yMTQwNCAwLS4wMDAwMDQuMDAwMDA0LS4wMDAwMDcuMDAwMDA4LS4wMDAwMTEuMDAwMDExbC01Ny4zNTI5MjEyIDU2LjE1NDUzMWMtMi40NDU1MzY4IDIuMzk0NDMyLTYuNDEwNTc1NSAyLjM5NDQ3Mi04Ljg1NjE2MTIuMDAwMDg3LS4wMDAwMTQzLS4wMDAwMTQtLjAwMDAyOTYtLjAwMDAyOC0uMDAwMDQ0OS0uMDAwMDQ0bC04MC44MTI0MTk0My03OS4xMjIxODVjLTIuNDQ1NTYwMjEtMi4zOTQ0MDgtMi40NDU1NjAyMS02LjI3NjUxMTUgMC04LjY3MDkxOTdsMTcuOTIxNzI5NjMtMTcuNTQ2ODY3M2MyLjQ0NTU2MDItMi4zOTQ0MDgyIDYuNDEwNTk4OS0yLjM5NDQwODIgOC44NTYxNjAyIDBsNTcuMzU0OTc3NSA1Ni4xNTUzNTdjLjYxMTM5MDguNTk4NjAyIDEuNjAyNjQ5LjU5ODYwMiAyLjIxNDAzOTggMCAuMDAwMDA5Mi0uMDAwMDA5LjAwMDAxNzQtLjAwMDAxNy4wMDAwMjY1LS4wMDAwMjRsNTcuMzUyMTAzMS01Ni4xNTUzMzNjMi40NDU1MDUtMi4zOTQ0NjMzIDYuNDEwNTQ0LTIuMzk0NTUzMSA4Ljg1NjE2MS0uMDAwMi4wMDAwMzQuMDAwMDMzNi4wMDAwNjguMDAwMDY3My4wMDAxMDEuMDAwMTAxbDU3LjM1NDkwMiA1Ni4xNTU0MzJjLjYxMTM5LjU5ODYwMSAxLjYwMjY1LjU5ODYwMSAyLjIxNDA0IDBsNTcuMzUzOTc1LTU2LjE1NDMyNDljMi40NDU1NjEtMi4zOTQ0MDkyIDYuNDEwNTk5LTIuMzk0NDA5MiA4Ljg1NjE2IDB6IiBmaWxsPSIjM2I5OWZjIi8+PC9zdmc+"),c.set(this,null),P.set(this,(t,a)=>(n(this,w,"f")[t]||(n(this,w,"f")[t]=[]),n(this,w,"f")[t].push(a),()=>n(this,A,"m",B).call(this,t,a))),g.set(this,()=>{const t=this.accounts[0];t?.publicKey&&(N(this,c,new it(t),"f"),n(this,A,"m",K).call(this,"change",{accounts:this.accounts}))}),L.set(this,()=>{n(this,c,"f")&&(N(this,c,null,"f"),n(this,A,"m",K).call(this,"change",{accounts:this.accounts}))}),I.set(this,()=>{n(this,l,"f").session?.namespaces?.solana?.accounts.length?n(this,g,"f").call(this):n(this,L,"f").call(this)}),q.set(this,async()=>(n(this,c,"f")||(X.push("ConnectingWalletConnect"),await n(this,l,"f").connect({namespaces:st([tt.DEFAULT_CHAIN])})),n(this,g,"f").call(this),{accounts:this.accounts})),F.set(this,async()=>{await n(this,l,"f").disconnect()}),v.set(this,async(...t)=>{if(!n(this,c,"f"))throw new Error("not connected");const a=[];if(t.length===1){const{transaction:s,account:r,chain:M,options:d}=t[0]||{},{minContextSlot:o,preflightCommitment:u,skipPreflight:f,maxRetries:h}=d||{};if(r?.address!==n(this,c,"f")?.address)throw new Error("invalid account");if(!Q(M||":"))throw new Error("invalid chain");if(!s)throw new Error("invalid transaction");const J=await n(this,l,"f").request({method:"solana_signAndSendTransaction",params:{transaction:s,pubkey:n(this,c,"f").address,sendOptions:{preflightCommitment:u,minContextSlot:o,maxRetries:h,skipPreflight:f}}});a.push({signature:p.decode(J.signature)})}else if(t.length>1){const s=await Promise.all(t.map(r=>n(this,v,"f").call(this,r)));for(const r of s)a.push(...r)}return a}),H.set(this,async(...t)=>{if(!n(this,c,"f"))throw new Error("not connected");const a=[];if(t.length===1){const{transaction:s,account:r,chain:M}=t[0]||{};if(r?.address!==n(this,c,"f").address)throw new Error("invalid account");if(M&&!Q(M))throw new Error("invalid chain");if(!s)throw new Error("invalid transaction");const d=O.from(s);let o;const u=await n(this,l,"f").request({method:"solana_signTransaction",params:{transaction:s,pubkey:n(this,c,"f").address}});if("signature"in u){const h=p.decode(u.signature);d.addSignature(new Z(n(this,c,"f").publicKey),x.from(h)),o=d}else{const h=x.from(u.transaction,"base64");y(d)&&(o=Y.deserialize(new Uint8Array(h))),o=O.from(h)}if(!o)throw new Error("invalid transaction");const f=y(o)?o.serialize():new Uint8Array(o.serialize({requireAllSignatures:!1,verifySignatures:!1}));a.push({signedTransaction:f})}else if(t.length>1){let s;for(const o of t){if(o.account?.address!==n(this,c,"f").address)throw new Error("invalid account");if(o.chain){if(!Q(o.chain))throw new Error("invalid chain");if(s&&o.chain!==s)throw new Error("conflicting chain");s=o.chain}}const r=t.map(({transaction:o})=>Y.deserialize(o)),d=(await n(this,l,"f").request({method:"solana_signAllTransactions",params:{transactions:r}})).transactions.map((o,u)=>{const f=r[u];if(!f)throw new Error("Invalid transactions response");const h=x.from(o,"base64");return y(f)?Y.deserialize(new Uint8Array(h)):O.from(h)});a.push(...d.map(o=>({signedTransaction:y(o)?o.serialize():new Uint8Array(o.serialize({requireAllSignatures:!1,verifySignatures:!1}))})))}return a}),U.set(this,async(...t)=>{if(!n(this,c,"f"))throw new Error("not connected");const a=[];if(t.length===1){const{message:s,account:r}=t[0]||{};if(r?.address!==n(this,c,"f").address)throw new Error("invalid account");if(!s)throw new Error("invalid message");const M=await n(this,l,"f").request({method:"solana_signMessage",params:{message:s,pubkey:n(this,c,"f").address}});a.push({signedMessage:s,signature:p.decode(M.signature)})}else if(t.length>1){const s=await Promise.all(t.map(r=>n(this,U,"f").call(this,r)));for(const r of s)a.push(...r)}return a}),N(this,l,e,"f"),this.setProvider(e),G(this)}setProvider(e){N(this,l,e,"f"),N(this,C,"WalletConnect","f"),e.on("connect",()=>n(this,g,"f").call(this)),e.on("disconnect",()=>n(this,L,"f").call(this)),e.on("accountsChanged",()=>n(this,I,"f").call(this)),e.on("chainChanged",()=>n(this,I,"f").call(this)),n(this,g,"f").call(this)}}w=new WeakMap,k=new WeakMap,l=new WeakMap,C=new WeakMap,b=new WeakMap,c=new WeakMap,P=new WeakMap,g=new WeakMap,L=new WeakMap,I=new WeakMap,q=new WeakMap,F=new WeakMap,v=new WeakMap,H=new WeakMap,U=new WeakMap,A=new WeakSet,K=function(e,...t){n(this,w,"f")[e]?.forEach(a=>a.apply(null,t))},B=function(e,t){n(this,w,"f")[e]=n(this,w,"f")[e]?.filter(a=>t!==a)};export{V as SolanaWalletConnectStandardWallet};
